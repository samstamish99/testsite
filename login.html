<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>TeamOps - Sign In</title>
    <link rel="stylesheet" href="styles.css">
    <script>
        (function () {
            var gp = document.createElement('script');
            gp.src = "https://onboarding-app-olive.vercel.app/snippet/loader.js";
            gp.async = true;
            gp.dataset.siteKey = "218fad9f0209e36ca34c6154845c9585";
            document.head.appendChild(gp);
        })();
    </script>
</head>
<body class="auth-page">
    <div class="auth-container">
        <div class="auth-card">
            <h1 class="logo">TeamOps</h1>
            <h2>Sign in to your account</h2>
            
            <form id="login-form" onsubmit="handleLogin(event)">
                <div class="form-group">
                    <label for="login-email">Email</label>
                    <input type="email" id="login-email" name="email" placeholder="you@example.com" required>
                </div>
                <div class="form-group">
                    <label for="login-password">Password</label>
                    <input type="password" id="login-password" name="password" placeholder="••••••••" required>
                </div>
                <div class="form-options">
                    <label class="checkbox-label">
                        <input type="checkbox" id="remember-me">
                        <span>Remember me</span>
                    </label>
                    <a href="#" onclick="showForgotPassword()" class="link">Forgot password?</a>
                </div>
                <button type="submit" class="btn btn-primary btn-block">Sign In</button>
            </form>

            <div class="auth-divider">
                <span>OR</span>
            </div>

            <button class="btn btn-secondary btn-block" onclick="showSignup()">Create new account</button>
        </div>
    </div>

    <!-- Sign Up Modal -->
    <div id="signup-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>Create Account</h3>
                <button class="modal-close" onclick="closeModal('signup-modal')">&times;</button>
            </div>
            <form id="signup-form" onsubmit="handleSignup(event)">
                <div class="form-group">
                    <label for="signup-name">Full Name</label>
                    <input type="text" id="signup-name" name="name" placeholder="John Doe" required>
                </div>
                <div class="form-group">
                    <label for="signup-email">Email</label>
                    <input type="email" id="signup-email" name="email" placeholder="you@example.com" required>
                </div>
                <div class="form-group">
                    <label for="signup-password">Password</label>
                    <input type="password" id="signup-password" name="password" placeholder="••••••••" required>
                </div>
                <div class="form-group">
                    <label for="signup-company">Company Name</label>
                    <input type="text" id="signup-company" name="company" placeholder="Acme Inc.">
                </div>
                <div class="modal-actions">
                    <button type="button" class="btn btn-secondary" onclick="closeModal('signup-modal')">Cancel</button>
                    <button type="submit" class="btn btn-primary">Create Account</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Forgot Password Modal -->
    <div id="forgot-password-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>Reset Password</h3>
                <button class="modal-close" onclick="closeModal('forgot-password-modal')">&times;</button>
            </div>
            <form id="forgot-password-form" onsubmit="handleForgotPassword(event)">
                <div class="form-group">
                    <label for="reset-email">Email</label>
                    <input type="email" id="reset-email" name="email" placeholder="you@example.com" required>
                </div>
                <p class="help-text">We'll send you a password reset link if an account exists.</p>
                <div class="modal-actions">
                    <button type="button" class="btn btn-secondary" onclick="closeModal('forgot-password-modal')">Cancel</button>
                    <button type="submit" class="btn btn-primary">Send Reset Link</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Toast Container -->
    <div id="toast-container" class="toast-container"></div>

    <script src="auth.js"></script>
    <script>
        function showSignup() {
            document.getElementById('signup-modal').style.display = 'flex';
        }

        function showForgotPassword() {
            document.getElementById('forgot-password-modal').style.display = 'flex';
        }

        function closeModal(modalId) {
            document.getElementById(modalId).style.display = 'none';
        }

        function handleLogin(event) {
            event.preventDefault();
            const email = document.getElementById('login-email').value;
            const password = document.getElementById('login-password').value;
            
            if (auth.login(email, password)) {
                showToast('Welcome back!');
                setTimeout(() => {
                    window.location.href = 'index.html';
                }, 500);
            } else {
                showToast('Invalid email or password', 'error');
            }
        }

        function handleSignup(event) {
            event.preventDefault();
            const name = document.getElementById('signup-name').value;
            const email = document.getElementById('signup-email').value;
            const password = document.getElementById('signup-password').value;
            const company = document.getElementById('signup-company').value;
            
            if (auth.signup(name, email, password, company)) {
                closeModal('signup-modal');
                showToast('Account created successfully!');
                setTimeout(() => {
                    window.location.href = 'index.html';
                }, 500);
            } else {
                showToast('Email already exists', 'error');
            }
        }

        function handleForgotPassword(event) {
            event.preventDefault();
            const email = document.getElementById('reset-email').value;
            closeModal('forgot-password-modal');
            showToast('Password reset link sent to ' + email);
        }

        function showToast(message, type = 'success') {
            const toast = document.createElement('div');
            toast.className = 'toast ' + (type === 'error' ? 'toast-error' : '');
            toast.textContent = message;
            document.getElementById('toast-container').appendChild(toast);
            
            setTimeout(() => toast.classList.add('show'), 10);
            setTimeout(() => {
                toast.classList.remove('show');
                setTimeout(() => toast.remove(), 300);
            }, 3000);
        }

        window.onclick = function(event) {
            const modals = ['signup-modal', 'forgot-password-modal'];
            modals.forEach(modalId => {
                const modal = document.getElementById(modalId);
                if (event.target === modal) {
                    closeModal(modalId);
                }
            });
        }

        // Redirect if already logged in
        if (auth.isAuthenticated()) {
            window.location.href = 'index.html';
        }
    </script>
</body>
</html>

